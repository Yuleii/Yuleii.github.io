---
layout: article
title: The  Bootstrap  Estimate  of Standard  Error 
key: 20210123
tags: Bootstrap Python Statistics InProgress
pageview: false
modify_date: 2021-01-23
aside:
  toc: true
---

<!--more-->

## Introduction

Bootstrap is a computer-based method for assigning measures of accuracy(bias, variance, confidence intervals, prediction error, etc.) to statistical estimates. The idea is to use the observed sample to estimate the population distribution. Then samples can be drawn from the estimated population and the sampling distribution of any type of estimator can itself be estimated. 

## The process of bootstrap

To fix notation:
- statistic of interest: $s(x)$
- a random observed sample:  $$x=(x_1, x_2,\dots,x_n)$$
- a bootstrap sample: $$x^*=(x^*_1, x^*_2,\dots,x^*_n)$$
- bootstrap replicates: $$s(x^{*1}), s(x^{*2}), \dots, s(x^{*B})$$
- bootstrap estimate of standard error: $$\hat{se}_{boot}$$


![1_bootstrap_process](/pictures/20210123/1_bootstrap_process.jpeg){:width="500"}

The figure shows the schematics of the bootstrap process for estimating the standard error of a statistic $s(x)$:
- Generate $B$ bootstrap samples $$x^{*1}, x^{*2},\dots,x^{*B}$$. Each bootstrap sample has $n$ elements, generated by sampling with replacement from the original data set $x$.
- Bootstrap replicates $$s(x^{*1}), s(x^{*2}), \dots, s(x^{*B})$$ are obtained by calculating the value of the statistic $s(x)$ on each bootstrap sample. If  $s(x)$  is  the sample  median/mean,  for instance,  then  $$s(x^*)$$  is  the  median/mean  of  the  bootstrap  sample.

- Finally, the bootstrap estimate of standard error of $s(x)$ is the standard deviation  of the bootstrap replications $$s(x^{*1}), s(x^{*2}), \dots, s(x^{*B})$$. 


## Parameter estimate

Suppose we face a common data-analytic situation: a random sample $x=(x_1, x_2, \dots, x_n)$ from an unknown probability distribution $F$ has been observed and we wish to estimate a parameter of interest $\theta=t(F)$ on the basis of $x$. For this purpose, we calculate an estimate $\hat{\theta}=s(x)$ from $x$. For this  purpose,  we  calculate  an  estimate  $\hat{\theta}  =  s(x)$  from  $x$. How  accurate is  $\hat{\theta}$? Bootstrap sampling can be carried out both non-parametrically and parametrically to estimate the the standard error of a statistic $\hat{\theta}$.

### Non-parametric bootstrap
In the nonparametric bootstrap a sample of the same size as the data is take from the data with replacement. What does this mean? It means that if you measure 10 samples, you create a new sample of size 10 by replicating some of the samples that you've already seen and omitting others.

To fix notations:
- a random sample:  $x=(x_1, x_2,\dots,x_n)$
- unknown probability distribution of population: $F$
- empirical distribution of a random sample $x$: $\hat{F}$
- bootstrap sample: $$\hat{F} \rightarrow (x^*_1, x^*_2,\dots,x^*_n)$$
- parameter of interest: $\theta=t(F)$
- estimate of $\theta$: $\hat{\theta}=s(x)$
- bootstrap replication of $$\hat{\theta}:\hat{\theta}^*=s(x^*)$$
- the bootstrap estimate of $se_F(\hat{\theta})$, the standard error of a statistic $\hat{\theta}$ is defined by $se_{\hat{F}}(\hat{\theta}^*)$


![bootstrap algorithm](/pictures/20210123/2_bootstrap_algorithm.jpg){:width="500"}

The bootstrap algorithm for estimating standard errors
1. Select  $B$  independent  bootstrap  samples $$x^{*1}, x^{*2},\dots,x^{*B}$$,  each  consisting  of n  data  values  drawn with replacement from $x$

2. Evaluate the bootstrap replication corresponding to each bootstrap sample.    
$$\hat{\theta}(b)=s(x^{*b}), b=1,2,\dots,B$$

3. Estimate the standard  error  $se_F(\hat{\theta})$ by  the sample  standard deviation of the $B$ replications
$$\hat{se}_B=\{\sum_{b=1}^B[\hat{\theta}(b)-\hat{\theta}^*(\cdot)]^2/(B-1)\}^{1/2}$$, where$$\hat{\theta}^*=\sum_{b=1}^B \hat{\theta}^*(b)/B$$


remarks:
- The bootstrap data set  $$x^*=(x^*_1, x^*_2,\dots,x^*_n)$$ consists of members of the original data set  $$x=(x_1, x_2,\dots,x_n)$$, some appearing zero  times, some appearing once,  some  appearing twice,  etc. Thus, we might  have  $$x^*_1  =  x_7,  x^*_2  =  x3,  x^*_3  =  x_3,  x^*_4  =  x_{22},  \dots , x_n^*  =  x_7$$. 

- If  $s(x)$  is  the sample  median/mean,  for instance,  then  $s(x^*)$  is  the  median/mean  of  the  bootstrap  sample.
- The  number  of  bootstrap replications  $B$  for estimating  a  standard  error  is  usually  between  25  and  200. 

### Parametric bootstrapping

Parametric bootstrapping assumes that the data comes from a known distribution with unknown parameters. (For example the data may come from a Poisson, negative binomial for counts, or normal for continuous distribution.) You estimate the parameters from the data that you have and then you use the estimated distributions to simulate the samples. 

To fix notations:
- parametric bootstrap estimate of standard error: $se_{\hat{F}_{par}}(\theta^*)$
- an estimate of $F$ derived from a parametric model for the data: $\hat{F}_{par}$

Same with the non-parametric bootstrap,parametric bootstrap approximate the ideal bootstrap estimate by bootstrap sampling, but in a different manner than before. Instead of sampling with replacement from  the data,  we  draw  $B$  samples  of size  $n$  from  the  parametric estimate of the population $F_{par}$:
$$\hat{F}_{par} \rightarrow(x^*_1, x^*_2,\dots,x^*_n)$$
After generating the bootstrap samples,  we  proceed  exactly as  in steps  2  and 3  of the non-parametric bootstrap algorithm:  evaluate statistic on each  bootstrap sample,  and then compute the standard deviation of the $B$  bootstrap replications.



### Parametric vs. Nonparametric Bootstrapping
To be added....


## Bootstrap in Python
To be added....

## References

- Efron, B., & Tibshirani, R.J. (1994). [An Introduction to the Bootstrap (1st ed.).](https://doi.org/10.1201/9780429246593) Chapman and Hall/CRC.
- [Advanced Data Analysis -The Bootstrap](https://www.stat.cmu.edu/~cshalizi/402/lectures/08-bootstrap/lecture-08.pdf)
- [Statistical Analysis of Genomics Data: 15.3-Bootstrapping](https://online.stat.psu.edu/stat555/node/119/)
- [Why use the parametric bootstrap?](https://stats.stackexchange.com/questions/96900/why-use-the-parametric-bootstrap)